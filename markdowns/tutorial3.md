# Ubuntu セットアップ マニュアル Part3
- [Ubuntu セットアップ マニュアル Part3](#ubuntu-セットアップ-マニュアル-part3)
  - [Part3の前に](#part3の前に)
  - [セーフブートとドライバのインストール](#セーフブートとドライバのインストール)
  - [アップデートとドライバのインストール](#アップデートとドライバのインストール)
  - [初期設定と各種ツールの設定](#初期設定と各種ツールの設定)
    - [リポジトリサーバの変更](#リポジトリサーバの変更)
    - [日本語入力の設定](#日本語入力の設定)
    - [システムUIの日本語化](#システムuiの日本語化)
    - [Visual Studio Codeのインストール](#visual-studio-codeのインストール)

## Part3の前に
現在使用している最新のPCには、Geforce RTX 4060TiというGPUが搭載されています。ただこのGPUとUbuntuの相性が悪く、インストール後に普通に再起動しても起動しない、という問題が発生します。そこでPart3ではその対処についても記述します。最新のPCでインストールを行っていない場合は適宜読み飛ばしてください。

## セーフブートとドライバのインストール
もしGeforce RTX 4060Tiの搭載されているPCを使用している場合、指示に従って再起動しても起動途中で止まることになります。この対応を行っていきましょう。<br>

まずセーフブートを行います。メーカーロゴが現れた直後に**ESC**キーを押し、GRUBのブートメニューを開きます。<br>
![Grub bootmenu](src/grub_options.png)<br>

Advanced Options For Ubuntuを選び、次に進みます。次に進むとRecovery modeを開くメニューが出ますので、Recovery modeを選びましょう。<br>
![Recov](src/grub_options_rec.png)<br>

Recovery modeを選ぶと、Recovery menuが開きます。このメニューから、まずは`network`を選択しネットワークに接続します。<br>

![Recovery menu](src/recov_menu.png)<br>

ネットワークに接続できたら、rootを選択してrootに入り、<br>
```
sudo apt update
sudo apt install nvidia-driver-550
```
を実行してnvidiaのドライバをインストールしましょう。(もしかしたらnvidia-driver-570でもいけるかもしれないが確証は持てない。)<br>
そしてインストールが終わったら、再起動しましょう。<br>

インストール後に再起動して、Terminal上で<br>
`nvidia-smi`<br>
を実行してGeforceの詳細が表示されれば、インストールは成功です。

<span style="color: gray">
ubuntuにおけるnvidia-driverはよく壊れますし、よくインストールに失敗します。もし失敗したり、壊れた場合は、一度nvidia-driverをアンインストールし、インストールしなおしてみましょう。それでもダメな場合はnouveau無効化(調べてみてください。)などの手段を取りましょう。時にはubuntuを一からセットアップした方が早い場合もあります。
</span>

## アップデートとドライバのインストール
ドライバインストール後、再起動すると、SSDからセーフブートなしでUbuntuが起動します。ここから、必須の設定を行います。<br>
まずはUbuntuのアップデートを行います。Terminal上で、<br>
`sudo apt update`<br>
と、<br>
`sudo apt upgrade`<br>
を実行してください。Ubunutu付属のパッケージがアップデートされます。その後必ず再起動してください。<br>

![Terminal上でアップデー卜する様子](src/teminal.png)<br>
図8　 Terminal上でsudo apt updateを打ち込んだ様子<br>


## 初期設定と各種ツールの設定
ここからはやった方がいい初期設定などを紹介していきます。

### リポジトリサーバの変更
*これは設定しなくても良いかもしれない。(最近は標準で日本のサーバになってることが多い。)*<br>
初期設定では、`apt`用のリポジトリサーバが日本のサーバになっていない場合があります。外国のサーバのままだと物理的に距離が離れすぎているので、ダウンロード速度が低下することになります。もし日本のサーバになっていない場合は、日本のサーバを選択しましょう。<br>
詳細な設定方法は、<br>
<a href="https://www.kkaneko.jp/tools/server/mirror.html" target="_blank" rel="noopener noreferrer">aptミラーサーバの設定(Ubuntu 上)</a> <br>
上記サイト(金子 邦彦研究室のWebサイトに公開されている資料)を参考にしてみてください。

### 日本語入力の設定
Ubuntuでも日本語入力用インプットメソッドを使用できます。ここでは**mozc**をインストールしてみます。Terminal上で、<br>
`sudo apt install ibus-mozc`<br>
としたあと、再起動します。そして設定アプリを開き、キーボード設定の入力ソースから日本語(mozc)を追加しましょう。<br>

![キーボード設定](src/key_settings.png)<br>
図1　キーボード設定

![キーボード設定](src/input_settings.png)<br>
図2　入力ソース

これで、日本語入力が可能になります。

### システムUIの日本語化
*この設定は任意です*<br>
設定アプリの`Region & Language`から使用する言語を変更しましょう。フォントやリソースパックが足りない、と言われることもあるので、足りないものは全て入れてしまいましょう。<br>
このとき(または再起動後)、homeやDocumentといったフォルダを日本語名にするか聞かれると思います。日本語にすると端末上での移動が大変面倒になるので、 英語のままでおいておきましょう。


### Visual Studio Codeのインストール
Ubuntu Softwareアプリからインストールすることができます。
検索し、Visual Studio Codeをインストールしましょう。
(動画を見たほうが早いかもしれません。)<br>

お疲れ様でした、このファイルの内容は以上です。自分で色々と試してみると、面白いと思います。もし分からないことがあれば、聞いてください。<br><br>

<span style="color: gray">
Ubuntuや他のLinuxディストリビューション、またオープンソースアプリケーションなど、触っていると楽しいものです。皆さんも色々みてみて遊んでみませんか？
</span>